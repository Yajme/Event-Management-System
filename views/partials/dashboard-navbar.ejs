
<script>
  var cookieValue1 = document.cookie;
  var cookiePairs1 = cookieValue1.split('; ');

let usernameCookieCount = 0;
let a_usernameCookieCount = 0;
let m_usernameCookieCount = 0;
let utypestud = 0;
let utypeadmin = 0;
let utypemod = 0;
for (var cookiePair of cookiePairs1) {
var [cookieName1, cookieValue1] = cookiePair.split('=');
if (cookieValue1 === 'student') {
  utypestud += 1;

}
if (cookieValue1 === 'admin') {
  utypeadmin += 1;
}
if (cookieValue1 === 'moderator'){
  utypemod += 1;
}

if (cookieName1 === 'std_id') {
usernameCookieCount += 1;

}
if (cookieName1 === 'a_std_id') {
a_usernameCookieCount += 1;

}
if (cookieName1 === 'm_std_id') {
m_usernameCookieCount += 1;
}
}

if(utypestud>0){
  window.onload = (event) => {
  document.getElementById("logout").href ="logout";
  document.getElementById("logout1").href ="logout";
};

if(usernameCookieCount<=0){
  document.location.href = "http://localhost:8080/student";
}
}


if(utypeadmin>0){
  window.onload = function() {
  document.getElementById('logout').href = '/admin/logout';
  }
if(a_usernameCookieCount<=0){
  document.location.href = "http://localhost:8080/admin";
}
}

if(utypemod>0){
  window.onload = function() {
  document.getElementById('logout').href = '/moderator/logout';
  }
if(m_usernameCookieCount<=0){
  document.location.href = "http://localhost:8080/moderator";
}
}
// Convert from vanilla js to ejs
// Ajax make a href change depending in usertype
// response.cookie generation = vanilla or native js retrieval 



</script>
<nav class="navbar default-layout-navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
    <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
      <a class="navbar-brand brand-logo" href="index.html"><img src="/images/Batangas_State_Logo.png" alt="logo" /></a>
    </div>
    <div class="navbar-menu-wrapper d-flex align-items-stretch">
      <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
        <span class="mdi mdi-menu"></span>
      </button>
    
      <ul class="navbar-nav navbar-nav-right">
        
      
        <li class="nav-item nav-profile dropdown">
          <a class="nav-link dropdown-toggle" id="profileDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
            <div class="nav-profile-img">
              <img src="/images/icon.png" alt="image">
            </div>
            <div class="nav-profile-text">
              <p class="mb-1 text-black"><span id="myId"></span></p>
                <script>
if(utypestud>0){
                  const cookieValue = document.cookie;
                  const cookiePairs = cookieValue.split('; ');
                
                let usernameCookieValue = '';
for (const cookiePair of cookiePairs) {
  const [cookieName, cookieValue] = cookiePair.split('=');
  if (cookieName === 'std_name') {
    usernameCookieValue = unescape(cookieValue);
    break;
  }
}
document.getElementById('myId').innerHTML=usernameCookieValue
}
if(utypeadmin>0){
                  const cookieValue = document.cookie;
                  const cookiePairs = cookieValue.split('; ');
                
                let usernameCookieValue = '';
for (const cookiePair of cookiePairs) {
  const [cookieName, cookieValue] = cookiePair.split('=');
  if (cookieName === 'a_std_name') {
    usernameCookieValue = unescape(cookieValue);
    break;
  }
}
document.getElementById('myId').innerHTML="Administrator"
}
if(utypemod>0){
  const cookieValue = document.cookie;
  const cookiePairs = cookieValue.split('; ');

let usernameCookieValue = '';
for (const cookiePair of cookiePairs) {
const [cookieName, cookieValue] = cookiePair.split('=');
if (cookieName === 'm_std_name') {
usernameCookieValue = unescape(cookieValue);
break;
}
}
document.getElementById('myId').innerHTML=usernameCookieValue
}

                </script>
            </div>
          </a>
          <div class="dropdown-menu navbar-dropdown dropdown-menu-right p-0 border-0 font-size-sm" aria-labelledby="profileDropdown" data-x-placement="bottom-end">
            <div class="p-3 text-center bg-primary">
              <img class="img-avatar img-avatar48 img-avatar-thumb" src="images/icon.png" alt="">
            </div>
            <div class="p-2">
              <h5 class="dropdown-header text-uppercase pl-2 text-dark">User Options</h5>
              <button type="button" class="btn primary" id="togbtn" style="background: transparent; font-family: 'nunito-medium', sans-serif; color: black; text-align: left; font-style: normal; font-size: .875rem; margin-left: 0px; padding-left: 10px; color: black;font-weight: 400;" data-toggle="modal" data-target="#myModal">Change Password</button>
              
              
              <div role="separator" class="dropdown-divider"></div>
              <h5 class="dropdown-header text-uppercase  pl-2 text-dark mt-2">Actions</h5>
             
              <a class="dropdown-item py-1 d-flex align-items-center justify-content-between" id="logout" href="#">
                <span>Log Out</span>
                <i class="mdi mdi-logout ml-1"></i>
              </a>
            </div>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link count-indicator dropdown-toggle" id="messageDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
            <i class="mdi mdi-email-outline"></i>
            <span class="count-symbol bg-success"></span>
          </a>
          <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="messageDropdown">
            <h6 class="p-3 mb-0 bg-primary text-white py-4"></h6>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item preview-item">
              <div class="preview-thumbnail">
                <img src="/images/Batangas_State_Logo.png" alt="image" class="profile-pic">
              </div>
              <div class="preview-item-content d-flex align-items-start flex-column justify-content-center">
                <h6 class="preview-subject ellipsis mb-1 font-weight-normal">Sport Fest Event upcoming!</h6>
                <p class="text-gray mb-0"> Will Happen in 5 days</p>
              </div>
            </a>
            <div class="dropdown-divider"></div>
           
          </div>
        </li>
       
      </ul>
      <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
        <span class="mdi mdi-menu"></span>
      </button>
    </div>
  </nav>


  <div class="w3-container">
    <h2>W3.CSS Modal</h2>
    <button onclick="" class="w3-button w3-black">Open Modal</button>
  
  </div>
  
            


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    
    
    <style>
    .form-label{
    color: black;
    font-weight: bold;
    }
    
    .input-container {
    display: -ms-flexbox; /* IE10 */
    display: flex;
    width: 100%;
    margin-bottom: 15px;
    }
    
    .icon {
    padding: 10px;
    background: dodgerblue;
    color: white;
    min-width: 50px;
    height: 45px;
    text-align: center;
    float: right;
    cursor: pointer;
    }
    
    .input-field {
    width: 100%;
    padding: 10px;
    outline: none;
    }
    
    .input-field:focus {
    border: 2px solid dodgerblue;
    }
    
    /* Set a style for the submit button */
    .btn {
    background-color: dodgerblue;
    color: white;
    padding: 15px 20px;
    border: none;
    cursor: pointer;
    width: 100%;
    opacity: 0.9;
    }
    
    .btn:hover {
    opacity: 1;
    }
    </style>
    <div class="modal fade" id="myModal" role="dialog" style="position: absolute;">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <form method="post" id="passForm" action="changepassword">
            <div class="mb-3">
              <label for="exampleInputEmail1" class="form-label">Old Password</label>
              <div class="input-container">
              <input type="password" id="password" class="form-control" name="oldpass" aria-describedby="emailHelp">
              <i class="bi bi-eye-slash icon" id="togglePassword" ></i>
            </div>
            
            <label for="exampleInputEmail1" class="form-label">New Password</label>
            <div class="input-container">
            <input type="password" id="password1" class="form-control" name="newpass" aria-describedby="emailHelp">
            <i class="bi bi-eye-slash icon" id="togglePassword1" ></i>
          </div>
          
          <label for="exampleInputEmail1" class="form-label">Confirm New Password</label>
          <div class="input-container">
          <input type="password" id="password2" class="form-control" name="confirmpass"  aria-describedby="emailHelp">
          <i class="bi bi-eye-slash icon" id="togglePassword2" ></i>
        </div>
        
          
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
        </div>
       
      </div>
      
    </div>
    </div>
    
    </div>
    <script>
    const togglePassword = document.querySelector("#togglePassword");
    const password = document.querySelector("#password");
    
    togglePassword.addEventListener("click", function () {
      // toggle the type attribute
      const type = password.getAttribute("type") === "password" ? "text" : "password";
      password.setAttribute("type", type);
      
      // toggle the icon
      this.classList.toggle("bi-eye");
    });
    
    // prevent form submit
    const form = document.querySelector("form");
    form.addEventListener('submit', function (e) {
      e.preventDefault();
    });
    
    const togglePassword1 = document.querySelector("#togglePassword1");
    const password1 = document.querySelector("#password1");
    
    togglePassword1.addEventListener("click", function () {
      // toggle the type attribute
      const type1 = password1.getAttribute("type") === "password" ? "text" : "password";
      password1.setAttribute("type", type1);
      
      // toggle the icon
      this.classList.toggle("bi-eye");
    });
    
    
    const togglePassword2 = document.querySelector("#togglePassword2");
    const password2 = document.querySelector("#password2");
    
    togglePassword2.addEventListener("click", function () {
      // toggle the type attribute
      const type2 = password2.getAttribute("type") === "password" ? "text" : "password";
      password2.setAttribute("type", type2);
      
      // toggle the icon
      this.classList.toggle("bi-eye");
    });
    
    const form4 = document.getElementById('passForm');
    const input1 = document.getElementById('password1');
    const input2 = document.getElementById('password2');
    
    form.addEventListener('submit', function (e) {
    if (input1.value !== input2.value) {
      e.preventDefault(); // Prevent the default submit action
      alert('The two Password must be equal.');
    }
    else{
      this.submit();
    }
    });
    </script>
     <% if(locals.messagepass){if(messagepass.length > 0 ){ %>
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script src="sweetalert2.min.js"></script>
<link rel="stylesheet" href="sweetalert2.min.css">
      <script>
      
      Swal.fire({
  position: "top-end",
  icon: "success",
  title: "Your password has been changed!",
  showConfirmButton: false,
  timer: 2500
});
      
      </script>
    
      <% } } %>
    
            
    
    